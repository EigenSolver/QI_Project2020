\chapter{Approximate quantum cloning}
\label{sec:approximateqcm}
\section{No-cloning theorem}
It is a fundamental result of quantum mechanics that a generic quantum states can not be copied exactly.
\section{Universal quantum cloning machine}
\section{Phase covariant quantum cloning machine}
A phase covariant quantum cloning machine (PCQCM) is a QCM optimized to clone states on an equator of the Bloch sphere.
The circuit for the optimal PCQCM proposed in  \cite{EquatorialQCM} is similar to the one for the UQCM, but the output copies are on the registers of the ancillae:

\[
\begin{quantikz}
    \lstick{$\ket{\psi}_{a_0}$} & \qw                  & \qw        & \qw                   & \qw       & \qw                   & \ctrl{2}  & \ctrl{1}      & \targ{}       & \targ{}        & \qw &  \\
    \lstick{$\ket{0}_{a_1}$}    & \qw                  & \targ{}    & \gate{R_y(\theta_2)}  & \ctrl{1}  & \qw                   & \qw       & \targ{}       & \qw           & \ctrl{-1}      & \qw & \rstick{\hspace{-4 mm}$\rho_{1}$}  \\
    \lstick{$\ket{0}_{a_2}$}    & \gate{R_y(\theta_1)} & \ctrl{-1}  & \qw                   & \targ{}   & \gate{R_y(\theta_3)}  & \targ{}   & \qw           & \ctrl{-2}     & \qw            & \qw & \rstick{\hspace{-4 mm}$\rho_{2}$}
\end{quantikz}
\]

The only significant difference is the preparation of the two ancillae. In this case, different angles of rotation are used.
In order to optimally clone the states on the $xz$ equator, the following angles have to be chosen:
\[
    \theta_1=\theta_3=\frac{\pi}{4}, \quad \theta_2=0.
\]

Hence, the circuit above can be rewritten removing the rotation $R_y(\theta_2)$:
\[
\begin{quantikz}
    \lstick{$\ket{\psi}_{a_0}$} & \qw                  & \qw         & \qw       & \qw                   & \ctrl{2}  & \ctrl{1}      & \targ{}        & \targ{}       & \qw &  \\
    \lstick{$\ket{0}_{a_1}$}    & \qw                  & \targ{}     & \ctrl{1}  & \qw                   & \qw       & \targ{}       & \qw           & \ctrl{-1}      & \qw & \rstick{\hspace{-4 mm}$\rho_{1}$}  \\
    \lstick{$\ket{0}_{a_2}$}    & \gate{R_y(\theta_1)} & \ctrl{-1}   & \targ{}   & \gate{R_y(\theta_3)}  & \targ{}   & \qw           & \ctrl{-2}     & \qw            & \qw & \rstick{\hspace{-4 mm}$\rho_{2}$}
\end{quantikz}
\]
The first two CNOT gates in this circuit act as a SWAP gate (because $\ket{0}_{a_1}$ is the input state of the central qubit). 
Hence, these two CNOT gates are not necessary. It is possible to ignore them, provided that $R_y(\theta_3)$ is moved to the second qubit. Since $\theta_1=\theta_3=\theta=\frac{\pi}{4}$, the final circuit is obtained

\[
\begin{quantikz}
    \lstick{$\ket{\psi}_{a_0}$} \slice{0} & \qw                           & \ctrl{2}  & \ctrl{1}  \slice{2}    & \targ{}       & \targ{}      \slice{3} & \qw  &  \\
    \lstick{$\ket{0}_{a_1}$}    & \gate{R_y(\pi/4)}                       & \qw       & \targ{}                & \qw           & \ctrl{-1}              & \qw & \rstick{\hspace{-4 mm}$\rho_{1}$}  \\
    \lstick{$\ket{0}_{a_2}$}    & \gate{R_y(\pi/4)} \slice{1}            & \targ{}    & \qw                    & \ctrl{-2}     & \qw                    & \qw & \rstick{\hspace{-4 mm}$\rho_{2}$}  
\end{quantikz}
\]

We have managed to greatly simplify the circuit. We have removed 5 CNOT gates from the circuit that we were using on real quantum processors with linear connectivity: the 2 CNOT gates mentioned here and the 3 CNOT gates that were necessary in order to implement the SWAP gate that was necessary to respect the connectivity constraints.
With this new circuit, only the top qubit has to be able to connect to the other two qubits.
As a final observation, since this circuit is much more simple than the one for the universal QCM, the average fidelity over the whole Bloch sphere could be greater in this case than with the universal QCM.

We will now show, step by step, that this circuit does clone states on the $xz$-equator.
We consider a generic input state
\[
    \ket{\psi}=\cos(\theta/2)\ket{0}+e^{i\phi}\sin(\theta/2)\ket{1},
\]
therefore the initial state of the full circuit is
\[
    \ket{\Psi_0}=\ket{\psi}_{a_0}\ket{0}_{a_1}\ket{0}_{a_2}.
\]
Each ancilla, after the rotation, is
\[
    R_y(\pi/4)\ket{0}=\cos(\pi/8)\ket{0}-\sin(\pi/8)\ket{1}.
\]
Hence, the two ancilla are prepared in the following state:
\[
    \begin{split}
    \ket{\phi}&=\big(\cos(\pi/8)\ket{0}+\sin(\pi/8)\ket{1}\big)\big(\cos(\pi/8)\ket{0}+\sin(\pi/8)\ket{1}\big)=\\
    &=\cos^2(\pi/8)\ket{00}+\cos(\pi/8)\sin(\pi/8)(\ket{01}+\ket{10})+\sin^2(\theta)\ket{11}.
    \end{split}
\]

Right before the CNOT gates, the state of the three qubits is:
\[
    \begin{split}
    \ket{\Psi_1}&=\big(\cos(\theta/2)\ket{0}+e^{i\phi}\sin(\theta/2)\ket{1}\big)\big(\cos(\pi/8)\ket{0}+\sin(\pi/8)\ket{1}\big)\big(\cos(\pi/8)\ket{0}+\sin(\pi/8)\ket{1}\big)=\\
    &=\cos(\theta/2)\cos^2(\pi/8)\ket{000}+e^{i\phi}\sin(\theta/2)\cos^2(\pi/8)\ket{100}\\
    &+\cos(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{010}+e^{i\phi}\sin(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{110}\\
    &+\cos(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{001}+e^{i\phi}\sin(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{101}\\
    &+\cos(\theta/2)\sin^2(\pi/8)\ket{011}+e^{i\phi}\sin(\theta/2)\sin^2(\pi/8)\ket{111}.
    \end{split}
\]
After applying the first two CNOT gates:
\[
    \begin{split}
    \ket{\Psi_2}&=\cos(\theta/2)\cos^2(\pi/8)\ket{000}+e^{i\phi}\sin(\theta/2)\cos^2(\pi/8)\ket{111}\\
    &+\cos(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{010}+e^{i\phi}\sin(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{101}\\
    &+\cos(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{001}+e^{i\phi}\sin(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{110}\\
    &+\cos(\theta/2)\sin^2(\pi/8)\ket{011}+e^{i\phi}\sin(\theta/2)\sin^2(\pi/8)\ket{100}.
    \end{split}
\]
After applying the last two CNOT gates:
\[
    \begin{split}
    \ket{\Psi_3}&=\cos(\theta/2)\cos^2(\pi/8)\ket{000}+e^{i\phi}\sin(\theta/2)\cos^2(\pi/8)\ket{111}\\
    &+\cos(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{110}+e^{i\phi}\sin(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{001}\\
    &+\cos(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{101}+e^{i\phi}\sin(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{010}\\
    &+\cos(\theta/2)\sin^2(\pi/8)\ket{011}+e^{i\phi}\sin(\theta/2)\sin^2(\pi/8)\ket{100}.
    \end{split}
\]
The above state is invariant under the exchange of the second and third qubits, where the copies are made. 
This means that the single qubit states of the two copies are the same, i.e.:
\[
    \rho_{1}=\rho_{2} \quad \text{where} \quad \rho_{1}=\Tr_{a_0,a_2}[\ketbra{\Psi_3}], \quad \rho_{2}=\Tr_{a_0,a_1}[\ketbra{\Psi_3}].
\]
In order to calculate the expected fidelity of the copies (we will consider the copy $\rho_{1}$), we first isolate the qubits $a_0$ and $a_2$:
\[
    \begin{split}
    \ket{\Psi_3}&=\ket{0}\big(\cos(\theta/2)\cos^2(\pi/8)\ket{0}+e^{i\phi}\sin(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{1}\big)\ket{0}\\
    &+\ket{0}\big(e^{i\phi}\sin(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{0}+\cos(\theta/2)\sin^2(\pi/8)\ket{1}\big)\ket{1}\\
    &+\ket{1}\big(e^{i\phi}\sin(\theta/2)\sin^2(\pi/8)\ket{0}+\cos(\theta/2)\sin(\pi/8)\cos(\pi/8)\ket{1})\ket{0}\\
    &+\ket{1}\big(\cos(\theta/2)\cos(\pi/8)\sin(\pi/8)\ket{0}+e^{i\phi}\sin(\theta/2)\cos^2(\pi/8)\ket{1}\big)\ket{1}.
    \end{split}
\]
The single copy fidelity is then ($\theta$ and $\phi$ are the angles on the Bloch sphere of the input state):
\[
    \begin{split}
    F(\theta,\phi)&=\bra{\psi}\rho_{1}\ket{\psi}=\bra{\psi}\Tr_{a_0,a_2}[\ketbra{\Psi_3}]\ket{\psi}=\\
    &=\big(\cos^2(\theta/2)\cos^2(\pi/8)+\sin^2(\theta/2)\cos(\pi/8)\sin(\pi/8)\big)^2\\
    &+\big|e^{i\phi}\cos(\theta/2)\sin(\theta/2)\sin(\pi/8)\cos(\pi/8)+e^{-i\phi}\sin(\theta/2)\cos(\theta/2)\sin^2(\pi/8)\big|^2\\
    &+\big|e^{i\phi}\cos(\theta/2)\sin(\theta/2)\sin^2(\pi/8)+e^{-i\phi}\sin(\theta/2)\cos(\theta/2)\sin(\pi/8)\cos(\pi/8)\big|^2\\
    &+\big(\cos^2(\theta/2)\cos(\pi/8)\sin(\pi/8)+\sin^2(\theta/2)\cos^2(\pi/8)\big)^2.
    \end{split}
\]
The fidelity can be computed analytically. The final result is:
\begin{equation}
    F(\theta,\phi)=\frac{3\left(4-\sqrt{2}\right)+\left(3\sqrt{2}-4\right)\left[\cos(2\phi)+\cos(2\theta)\left(1-\cos(2\phi)\right)\right]}{     16(2-\sqrt{2})   }.
\end{equation}
\begin{figure}[H]
    \centering
            \includegraphics[width=0.5\textwidth]{Figures/phase_covariant.png}
        \label{fig:phase_covariant}
        \caption{Caption}
\end{figure}
It is possible to observe that if $\phi=0$ is set, the fidelity becomes a constant:
\[
    F(\theta,0)=\frac{3\left(4-\sqrt{2}\right)+\left(3\sqrt{2}-4\right)}{16(2-\sqrt{2})}=\frac{8}{16(2-\sqrt{2})}=\frac{1}{2}\frac{2+\sqrt{2}}{2}=\frac{1}{2}+\frac{1}{\sqrt{8}}.
\]
Therefore, for input states on the $xz$-equator, the fidelity of the PCQCM is:
\begin{equation}
    F_{equator}^{ideal}=\frac{1}{2}+\frac{1}{\sqrt{8}}\approx 0.854.
    \label{eqn:fidelity_pcqcm}
\end{equation}

As discussed in \cite{PhaseCovariantOptimalBruss} this is the optimal fidelity for a PCQCM. 
Moreover, this is the optimal result attainable also when trying to maximize the fidelity for BB84 input states.
Indeed, the optimization over the two different sets of input states is equivalent and leads therefore to the same result \cite{PhaseCovariantOptimalBruss}.

It might be of some interest to consider the performances of the PCQCM over the whole Bloch sphere.
The average fidelity over the Bloch sphere $S$ is (integrating over solid angle):
\begin{equation}
    \overline{F}=\frac{1}{\int_S \dd{\Omega}}\int_S F(\Omega)\dd{\Omega}=\frac{1}{4\pi}\int_0^{2\pi}\int_0^\pi F(\theta,\phi)\sin(\theta)\dd{\theta}\dd{\phi}=\frac{7+2\sqrt{2}}{12}\approx 0.819.
    \label{eqn:avg_fidelity_pcqcm}
\end{equation}
The standard deviation can be calculated similarly:
\begin{equation}
    \sigma_{F}=\sqrt{\overline{F^2}-\overline{F}^2}=\frac{1}{6}\sqrt{\frac{3-2\sqrt{2}}{5}}\approx0.031.
    \label{eqn:std_fidelity_pcqcm}
\end{equation}

We conclude that when considering the PCQCM over the whole Bloch sphere, it is not too far from the optimal bound of the UQCM (which was $F=5/6\approx 0.833$).
This could have some interesting consequences: since we managed to greatly simplify its circuit, the PCQCM could turn to be better than the UQCM when using real hardware, in contrast with what is expected theoretically.
A similar analysis regarding the performances of a real QCM was carried out in \cite{LowCostCloning} in the context of economical QCMs.

\subsection*{Rotated PCQCM}
The found expression for the fidelity is rather complicated. When considering a PCQCM that optimally clones the states on the $xy$-equator, the expression simplifies.
It is possible to obtain the fidelity for an arbitrary state on the Bloch sphere starting from the expression previously found, without analyzing a new circuit.
Given a point $(\theta,\phi)$ on the Bloch sphere, we want to find the coordinates $(\theta',\phi')$ of such point after a rotation of $\pi/2$ about the $x$-axis is performed.
Indeed, such rotation transforms the $xy$-equator into the $xz$-equator.

We start considering a generic vector on a sphere of unit radius:
\[
    \bm v = \begin{pmatrix}
        \sin(\theta)\cos(\phi)\\
        \sin(\theta)\sin(\phi)\\
        \cos(\phi)
    \end{pmatrix}.
\]
An arbitrary rotation about the $x$-axis in a $3D$ Euclidean space is given by:
\[
    R_x(\alpha)=\begin{pmatrix}
        1 & 0 & 0 \\
        0 & \cos(\alpha) & -\sin(\alpha) \\
        0 & \sin(\alpha) & \cos(\alpha)
    \end{pmatrix}
\]
Therefore, if we consider a rotation of $\pi/2$ about the $x$-axis, the transformed vector is:
\[
    \bm v' = R_x(\pi/2)\bm v = \begin{pmatrix}
        1 & 0 & 0 \\
        0 & 0 & -1 \\
        0 & 1 & 0 \\
    \end{pmatrix}
    \begin{pmatrix}
        \sin(\theta)\cos(\phi)\\
        \sin(\theta)\sin(\phi)\\
        \cos(\phi)
    \end{pmatrix}=\begin{pmatrix}
        \sin(\theta)\cos(\phi)\\
        -\cos(\phi)\\
        \sin(\theta)\sin(\phi)
    \end{pmatrix}.
\]
Finally, the new angular coordiantes can be calculated:
\[
    \begin{gathered}
    \theta'=\arccos(\frac{v'_z}{v'})=\arccos(\sin(\theta)\sin(\phi))\\
    \phi'=\atantwo\left(v'_y,v'_x\right)=\atantwo\left(-\cos(\phi),\sin(\theta)\cos(\phi)\right)
    \end{gathered}
\]
The fidelity for a PCQCM that optimally clones the state on the $xy$-equator is obtained from the one previously found simply changing the variables:
\[
    F_{xy}(\theta,\phi)=F(\theta'(\theta,\phi),\phi'(\theta,\phi)).
\]
After some manipulations, it is possible to obtain the following expression:
\begin{equation}
    F_{xy}(\theta,\phi)=\frac{5+\sqrt{2}}{8}+\frac{1-\sqrt{2}}{8}\cos(2\theta).
\end{equation}
\begin{figure}[H]
\centering
    \begin{minipage}[t]{.5\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/plot_1D_phase_covariant_different_labels.png}
        \label{fig:phase_covariant_rotated_1d}
        \caption{Caption (TO FIX)}
    \end{minipage}%
    \begin{minipage}[t]{.5\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/phase_covariant_rotated.png}
        \label{fig:phase_covariant_rotated}
        \caption{Caption (TO FIX)}
    \end{minipage}
\end{figure}

It is possible to observe that the fidelity does not depend on $\phi$, which means that it is constant across sections parallel to the $xy$-plane.
This was not evident with the previous expression, since the sections parallel to the $xz$-plane do not have such a simple expression.

We conclude observing that if $\theta=\pi/2$ (i.e. on the equator), we obtain $F_{xy}(\pi/2,\phi)=\frac{1}{2}+\frac{1}{2\sqrt{2}}$, which is the maximum fidelity achievable.
On the other hand, for $\theta=0$ or $\theta=\pi$, we obtain the minimum fidelity, i.e. $F_{xy}(0,\phi)=3/4$. Regardless of the equator that is optimally copied, the fidelity is then bounded by
\begin{equation}
    \frac{3}{4}\leq F(\theta,\phi) \leq \frac{1}{2}+\frac{1}{2\sqrt{2}}.
\end{equation}
\section{Economical phase covariant quantum cloning machine}
The two previous QCMs used $3$ qubits in order to implement the approximate $1 \to 2$ cloning. 
One may wonder whether the extra ancillary qubit is necessary.
It turns out that in certain cases it is not. The QCMs that only use $2$ qubits are known as economical quantum cloning machines (EQCM) \cite{EconomicalNiuGriffiths}.
The advantage of EQCMs consists in the fact that their experimental implementation requires less resources.
In particular, it was proven that a universal EQCM does not exist \cite{EconomicalQCAnyDimension}. 
On the other hand, it is possible to build a phase covariant economical quantum cloning machine (PCEQCM), as discussed in the references above.

The circuit to implement a PCEQCM that optimally clones that states on the $xy$-equator is 
\begin{center}
    \begin{quantikz}
    \lstick{$\ket{\psi}_{a_0}$}  \slice{0}   & \ctrl{1}   \slice{1}  & \targ{}   \slice{2}    &\qw &  \rstick{\hspace{-4 mm}$\rho_1$}\\
    \lstick{$\ket{0}_{a_1}$}    & \gate{H}              & \ctrl{-1}     &\qw & \rstick{\hspace{-4 mm}$\rho_2$} 
    \end{quantikz}
\end{center}
where the controlled-Hadamard can be rewritteng using more elementary gates:
\begin{center}
    \begin{quantikz}
        & \ctrl{2}   & \qw           &   && \qw              & \qw      & \qw               & \ctrl{2}   &\qw      &\qw      &\qw    &\qw \\[-0.3cm]
        &            &               & = &&                 &          &                   &            &         &         &        &\\[-0.3cm]
        & \gate{H}   & \qw           &   && \gate{S^\dagger} & \gate{H} & \gate{T^\dagger}  & \targ{}    &\gate{T} &\gate{H} &\gate{S}& \qw\\
    \end{quantikz}
\end{center}

We are going to analyze the circuit considering an arbitrary input state $\ket{\psi}=\cos(\theta/2)\ket{0}+e^{i\phi}\sin(\theta/2)\ket{1}$.
The initial state is
\[
    \ket{\Psi_0}=\cos(\theta/2)\ket{00}+e^{i\phi}\sin(\theta/2)\ket{10}.
\]
After applying the controlled-Hadamard gate we obtain
\[
    \ket{\Psi_1}=\cos(\theta/2)\ket{00}+\frac{1}{\sqrt{2}}e^{i\phi}\sin(\theta/2)\ket{10}+\frac{1}{\sqrt{2}}e^{i\phi}\sin(\theta/2)\ket{11}.
\]
Finally, applying the CNOT gate, we get:
\[
    \ket{\Psi_2}=\cos(\theta/2)\ket{00}+\frac{1}{\sqrt{2}}e^{i\phi}\sin(\theta/2)\ket{10}+\frac{1}{\sqrt{2}}e^{i\phi}\sin(\theta/2)\ket{01}.
\]

The above state is invariant under exchange of qubits. This means that the single qubit states are the same, i.e.:
\[
    \rho_{1}=\rho_{2} \quad \text{where} \quad \rho_{1}=\Tr_{a_1}[\ketbra{\Psi_2}], \quad \rho_{2}=\Tr_{a_0}[\ketbra{\Psi_2}].
\]

Since there are only two qubits, it is feasible to calculate the density matrix of the final state of two qubits:
\[
    \rho_{a_0 a_1}=\ketbra{\Psi_2}{\Psi_2}=\frac{1}{2}\begin{pmatrix}
        \cos ^2\left(\frac{\theta }{2}\right) & \frac{e^{-i \phi } \sin (\theta )}{2 \sqrt{2}} & \frac{e^{-i \phi } \sin (\theta )}{2 \sqrt{2}} & 0 \\
        \frac{e^{i \phi } \sin (\theta )}{2 \sqrt{2}} & \frac{1}{2} \sin ^2\left(\frac{\theta }{2}\right) & \frac{1}{2} \sin ^2\left(\frac{\theta }{2}\right) & 0 \\
        \frac{e^{i \phi } \sin (\theta )}{2 \sqrt{2}} & \frac{1}{2} \sin ^2\left(\frac{\theta }{2}\right) & \frac{1}{2} \sin ^2\left(\frac{\theta }{2}\right) & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}.
\]
The reduced density matrix for the copies is:
\[
    \rho_1=\Tr_{a_1}[\rho_{a_0 a_1}]=
        \begin{pmatrix}
            \cos (\theta )+3 & \sqrt{2} e^{-i \phi } \sin (\theta ) \\
            \sqrt{2} e^{i \phi } \sin (\theta ) & 1-\cos (\theta ) \\
        \end{pmatrix}=\rho_2.
\]
When comparing the copies with the input state, the following fidelity is obtained:
\begin{equation}
    F_{xy}(\theta,\phi)=\expval{\rho_1}{\psi}=\expval{\rho_2}{\psi}=\frac{1}{8} \left(2 \cos (\theta )-\left(\sqrt{2}-1\right) \cos (2 \theta )+\sqrt{2}+5\right).
\end{equation}
It is possible to observe that the fidelity does not depend on $\phi$. Moreover, for $\theta=\frac{\pi}{2}$ (i.e. on the $xy$-equator):
\[
    F_{xy}(\pi/2,\phi)=\left(\frac{1}{2}+\frac{1}{2\sqrt{2}}\right)\approx 0.854.
\]
This is the same value obtained in the previous section for the PCQCM with the extra ancillary qubit.
\begin{figure}[H]
    \begin{minipage}{.5\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/plot_1D_economical_phase_covariant.png}
        \label{fig:economical_phase_covariant_rotated_1d}
        \caption{Caption (TO FIX)}
      \end{minipage}%
      \begin{minipage}{.5\textwidth}
        \centering
        \includegraphics[width=\textwidth]{Figures/economical_phase_covariant_rotated.png}
        \label{fig:economical_phase_covariant_rotated}
        \caption{Caption (TO FIX)}
      \end{minipage}
    \end{figure}
The average fidelity on the whole Bloch sphere is
\begin{equation}
    \overline{F}_{xy}=\frac{1}{\int_S \dd{\Omega}}\int_S F_{xy}(\Omega)\dd{\Omega}=\frac{1}{2}\int_0^\pi F_{xy}(\theta,\phi)\sin(\theta)\dd{\theta}=\frac{7+2\sqrt{2}}{12}\approx 0.819.
    \label{eqn:avg_fidelity_epcqcm}
\end{equation}
The standard deviation is
\begin{equation}
    \sigma_{{F}_{xy}}=\sqrt{\overline{F^2}_{xy}-\overline{F}^2_{xy}}
    =\frac{1}{12} \sqrt{\frac{1}{5} \left(27-8 \sqrt{2}\right)}\approx 0.148.
    \label{eqn:std_fidelity_epcqcm}
\end{equation}

The average fidelity is the same obtained in the previous section for the PCQCM, but in this case the standard deviation is larger.
Indeed, the fidelity is bounded by 
\begin{equation}
    \frac{1}{2}\leq F_{xy}(\theta,\phi)\leq 1,
\end{equation}
where the minimum is reached at $\theta=\pi$ (the South Pole) and the maximum is reached at $\theta=0$ (the North Pole).
This means that the states in the northern emisphere of the Bloch sphere are cloned better than those on the $xy$-equator,
whereas those in the southern emisphere are cloned worse.


\subsection*{Rotated EPCQCM}
Since we are interested in cloning the states on the $xz$-equator, we have to perform a rotation before and after the circuit discussed above.
The EPCQCM that optimally clones the $xz$-equator can be implemented using the following circuit:

\begin{center}
    \begin{quantikz}
    \lstick{$\ket{\psi}_{a_0}$}             & \gate{R_x(-\pi/2)}  & \ctrl{1}    & \targ{}       & \gate{R_x(\pi/2)} & \qw &  \rstick{\hspace{-4 mm}$\rho_1$}\\
    \lstick{$\ket{0}_{a_1}$}    & \qw                  &\gate{H}    & \ctrl{-1}    & \gate{R_x(\pi/2)} & \qw & \rstick{\hspace{-4 mm}$\rho_2$} 
    \end{quantikz}
\end{center}
The fidelity of the copies using the rotated EPCQCM can be calculated as we have shown for the PCQCM. In this case it was more convenient to analyze the circuit for the $xy$-equator.
The fidelity for an EPCQCM that optimally clones the $xz$-equator is:

\begin{equation}
    F(\theta,\phi)=\frac{1}{4}\left(2+\sqrt{2}-\sin(\theta)\sin(\phi)+(\sqrt{2}-1)\sin^2(\theta)\sin^2(\phi)\right)
\end{equation}

\begin{figure}[H]
    \centering
            \includegraphics[width=0.5\textwidth]{Figures/economical_phase_covariant.png}
        \label{fig:economical_phase_covariant}
        \caption{Caption}
\end{figure}
This is the circuit that we have run and the fidelity that we will compare our results with.

\section{Quantum cloning and quantum key distribution}

NB: optimal cloning and optimal eavesdropping are different!
When using the 3 qubit phase covariant QCM Eve also has the ancilla, which carries some additional information. See \cite{QuantumCloningReviewScarani}
"In summary: without ancilla, Eve can make the best possible guess on the bit sent by Alice (because the machine realizes the optimal phase-covariant cloning) but has very poor information about the result obtained by Bob. 
Adding the ancilla does not modify the estimation of Alice’s bit but allows Eve to deterministically symmetrize her information on Alice and Bob’s symbols. 
However, the two machines are equally good from the point of view of cloning."